# 0.2.0 更新一览

**注意：0.2.0的存档与0.1.0不兼容！**
**注意：0.2.0的存档与0.1.0不兼容！**
**注意：0.2.0的存档与0.1.0不兼容！**

## 新功能

- 新增初始布局功能，通过目录下的`Default Layout.ini`生成程序启动时的初始模板
- 新增`模块节点`与`输入输出节点`，`模块节点`指向一个模块工程，通过内部工程的`输入输出节点`与所在工程进行交互。
- 新增模板管理功能，可以将模板置入`Templates`文件夹进行统一管理
- 新增模块管理功能，可以将模块置入`Modules`文件夹进行统一管理
- 新增本地化文件`Locales.json`，现在大多数文本已被汉化，如有漏网之鱼请反馈
- 新增日志功能，日志会保存在logs文件夹
- 键值对的左侧现在会有一个专用于输出该键值对的值的引脚
- 新增复制`Ctrl+C`，粘贴`Ctrl+V`，快速复制`Ctrl+D`快捷键
  - 剪贴板中有INI文本内容的时候使用`Ctrl+V`可以粘贴为节点
- 新增占位符功能，允许输出INI时将占位符按照规则替换为文本，具体规则见下
- 新增节点、引脚、引线的样式管理器，可以调整元素的颜色等视觉效果、管理已有的样式或新增样式
- 新增节点的类型管理器，可以通过其快速管理当前支持的类型数据

## 功能拓展

- 节的名字现在嵌入显示，双击名字可进入编辑模式
- 左侧面板中现在可以双击或右键节点来更改节点的名字
- 左侧面板中添加了一个筛选按钮，用于根据节点类型来筛选节点
- 具有连线关系的键值对现在会更智能的变化值的内容
- 导入INI之后，节的类型现在会智能匹配识别，同时在节的右键菜单中新增了智能匹配类型的选项
- 调整模板的效果，现在在放置一个模板时，会将模板内的节全部放置在画布上
- 注释节点现在可以双击输入注释内容
- 组节点现在可以双击标题修改组名
- 对于涉及继承的节，现在被继承的节会预先输出
  - 每个节仅能输出一次，循环继承的情况下，输出的节会有注释提示
- 调整了节/键的注释和继承的显示效果

## 问题修复与优化

- 现在按Esc不再会关闭程序
- 修复了INI读取时可能串行的问题
- 修复了载入INI后自动布局未正确生效的问题
- 修复了通过右键菜单生成的节点位置不正确的问题
- 现在输入中文不再会乱码

---

# 占位符使用说明

提供了强大的字符串占位符替换功能。通过形如 `${KEY}` 或 `${KEY:参数}` 的格式，可动态生成内容，例如当前时间、随机字符串、环境变量值等。

## 基础语法

占位符格式如下：

```text
${KEY}
${KEY:参数}
```
- `KEY` 是关键字，用于指示要替换的类型
- `参数` 是可选项，用于进一步控制替换行为（如长度、格式等）

## 时间相关

| 占位符 | 说明 |
|--------|------|
| `${TIMESTAMP}` | 当前时间的毫秒时间戳 |
| `${DATETIME}` | 当前时间，格式为 `YYYY-MM-DD_HH-MM-SS` |
| `${DATE}` | 当前时间，默认格式为 `YYYYMMDDHHMMSS` |
| `${DATE:%Y-%m-%d}` | 自定义时间格式（使用 `strftime` 语法） |

## 随机生成

| 占位符 | 说明 |
|--------|------|
| `${RANDOM}` | 生成一个长度为 8 的随机字符串（大小写字母 + 数字） |
| `${RANDOM:12}` | 生成一个长度为 12 的随机字符串 |
| `${RANDOM_16}` | 同上，用关键字指定长度 |
| `${UUID}` | 生成一个符合 UUID v4 规范的字符串 |

## 项目信息

| 占位符 | 说明 |
|--------|------|
| `${PROJECT}` | 所在项目/模块名称 |

## 环境变量

| 占位符 | 说明 |
|--------|------|
| `${ENV:VAR_NAME}` | 获取系统环境变量 `VAR_NAME` 的值（若不存在则返回空字符串） |

## 自动计数器

用于生成递增的编号，支持多种格式。

### 基础用法

| 占位符 | 说明 |
|--------|------|
| `${COUNTER}` | 默认从 `1` 开始，步长为 `1`，十进制格式，宽度 0 |
| `${COUNTER:step=2}` | 步长为 2 |
| `${COUNTER:width=4}` | 输出宽度为 4，使用前导 `0` 填充（例如：`0001`） |
| `${COUNTER:base=hex}` | 使用十六进制格式 |
| `${COUNTER:base=oct}` | 使用八进制格式 |
| `${COUNTER:format=编号%04d}` | 自定义格式化字符串，支持 C 风格格式，例如输出 `编号0001` |

> 多个参数用逗号隔开：`${COUNTER:step=1,width=5,base=hex}`

## 哈希值

| 占位符 | 说明 |
|--------|------|
| `${HASH:abc123}` | 对字符串 `abc123` 计算 djb2 哈希值，结果为 8 位十六进制字符串 |

## 嵌套替换

所有占位符支持嵌套，例如：
```
${HASH:${UUID}}
```
先生成 UUID，再对其进行哈希。

## 示例

| 输入字符串 | 替换结果（示例） |
|------------|------------------|
| `Warhead${PROJECT}` | `WarheadCurrentProject` |
| `Build_${DATE}` | `Build_20250413` |
| `ID_${RANDOM:6}` | `ID_A8f9Zx` |
| `Env=${ENV:USERNAME}` | `Env=YourUserName` |
| `Infantry${COUNTER:step=10,width=3}` | `Infantry010`、`Infantry020`、`Infantry030`... |
| `Hash=${HASH:abc}` | `Hash=e2a6c4f3` |

## 注意事项

- 占位符支持多层嵌套，会一直处理到所有层级都替换完成。
- 未识别的占位符会被替换为空字符串。
- 某些关键字（如 `COUNTER`）在内部具有状态，可跨多次调用保持连续性。

